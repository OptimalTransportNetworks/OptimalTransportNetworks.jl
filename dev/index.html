<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · OptimalTransportNetworks.jl</title><meta name="title" content="Home · OptimalTransportNetworks.jl"/><meta property="og:title" content="Home · OptimalTransportNetworks.jl"/><meta property="twitter:title" content="Home · OptimalTransportNetworks.jl"/><meta name="description" content="Documentation for OptimalTransportNetworks.jl."/><meta property="og:description" content="Documentation for OptimalTransportNetworks.jl."/><meta property="twitter:description" content="Documentation for OptimalTransportNetworks.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>OptimalTransportNetworks.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Performance-Notes"><span>Performance Notes</span></a></li></ul></li><li><a class="tocitem" href="api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SebKrantz/OptimalTransportNetworks.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SebKrantz/OptimalTransportNetworks.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="OptimalTransportNetworks.jl"><a class="docs-heading-anchor" href="#OptimalTransportNetworks.jl">OptimalTransportNetworks.jl</a><a id="OptimalTransportNetworks.jl-1"></a><a class="docs-heading-anchor-permalink" href="#OptimalTransportNetworks.jl" title="Permalink"></a></h1><p><strong>Optimal Transport Networks in Spatial Equilibrium - in Julia and MATLAB</strong></p><p>Modern Julia (<a href="https://github.com/jump-dev/JuMP.jl">JuMP</a>) translation of the MATLAB OptimalTransportNetworkToolbox (v1.0.4b) implementing the quantitative spatial economic model of:</p><p>Fajgelbaum, P. D., &amp; Schaal, E. (2020). Optimal transport networks in spatial equilibrium. <em>Econometrica, 88</em>(4), 1411-1452.</p><p>The model/software uses duality principles to optimize over the space of networks, nesting an optimal flows problem and a neoclasical general-equilibrium trade model into a global network design problem to derive the optimal (welfare maximizing) transport network (extension) from any primitive set of economic fundamantals [population per location, productivity per location for each of <em>N</em> traded goods, endowment of a non-traded good, and (optionally) a pre-existing transport network]. For more information about the model see <a href="https://github.com/SebKrantz/OptimalTransportNetworks.jl/tree/main/misc/paper_materials">this folder</a>.</p><p>The model is the first of its kind and a pathbreaking contribution towards the welfare maximizing planning of transport infrastructure. Its creation has been funded by the European Union through an <a href="https://cordis.europa.eu/project/id/804095">ERC Research Grant</a>. The author of this Julia library has no personal connections to the authors, but has used their Matlab library for research purposes and belives that it deserves an accessible open-source implementation. Community efforts to further improve the code are welcome. In particular, there is a probabilistic extenstion to solving the model using MCMC methods which may be more suitable for large networks, implemented in:</p><p>Kreindler, G., Gaduh, A., Graff, T., Hanna, R., &amp; Olken, B. A. (2023). Optimal Public Transportation Networks: Evidence from the World&#39;s Largest Bus Rapid Transit System in Jakarta (No. w31369). National Bureau of Economic Research.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>The code for this example is in <a href="https://github.com/SebKrantz/OptimalTransportNetworks.jl/blob/main/examples/example04.jl">example04.jl</a>. See the <a href="https://github.com/SebKrantz/OptimalTransportNetworks.jl/blob/main/examples">examples folder</a> for more examples.</p><p>This plot shows the endowments on a map-graph: circle size is population, circle colour is productivity (the central node is more productive), the black lines indicate geographic barriers, and the background is shaded according to the cost of network building (elevation), indicating a mountain in the upper right corner. </p><p><img src="https://raw.githubusercontent.com/SebKrantz/OptimalTransportNetworks.jl/main/misc/figures/example04_setup.png" alt/></p><p>This plot shows the optimal network after 200 iterations, keeping population fixed and not allowing for cross-good congestion. The size of nodes indicates consumption in each node. </p><p><img src="https://raw.githubusercontent.com/SebKrantz/OptimalTransportNetworks.jl/main/misc/figures/example04_solution.png" alt/></p><h2 id="Performance-Notes"><a class="docs-heading-anchor" href="#Performance-Notes">Performance Notes</a><a id="Performance-Notes-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Notes" title="Permalink"></a></h2><ul><li><p>The Julia implementation does not provide hard-coded Gradients, Jacobians, and Hessians as the MATLAB implementation does for some model cases, but relies solely on JuMP&#39;s automatic differentiation. This has proven ineffective for dual solutions to the model where the objective is quite complex. Thus, at present, duality does not help to speed up computations in Julia, and accordingly the default is <code>duality = false</code>. I expect this to change in when <a href="https://github.com/jump-dev/JuMP.jl/issues/3738">support for detecting nonlinear subexpressions</a> will be added to JuMP.  </p></li><li><p>Related, I expect symbolic autodifferentiation via <a href="https://github.com/lanl-ansi/MathOptSymbolicAD.jl">MathOptSymbolicAD.jl</a> to provide significant performance improvements. Presently this cannot be used on these models because logical or comparison operators are not supported. See <a href="https://github.com/lanl-ansi/MathOptSymbolicAD.jl/issues/31">this issue</a>. Once support is added, the symbolic backend can be activated using:</p><p>```julia   import MathOptInterface as MOI   import MathOptSymbolicAD</p><p>param[:model_attr] = Dict(:backend =&gt; (MOI.AutomaticDifferentiationBackend(),                                           MathOptSymbolicAD.DefaultBackend()))                                    # Or:  MathOptSymbolicAD.ThreadedBackend()   ```</p></li><li><p>It is recommended to use Coin-HSL linear solvers for <a href="https://github.com/jump-dev/Ipopt.jl">Ipopt</a> to speed up computations. In my opinion the simplest way to use them is to get a (free for academics) license and download the binaries <a href="https://licences.stfc.ac.uk/product/coin-hsl">here</a>, extract them somewhere, and then set the <code>hsllib</code> (place here the path to where you extracted <code>libhsl.dylib</code>, it may also be called <code>libcoinhsl.dylib</code>, in which case you may have to rename it to <code>libhsl.dylib</code>) and <code>linear_solver</code> options as follows:</p><p><code>julia   param[:optimizer_attr] = Dict(:hsllib =&gt; &quot;/usr/local/lib/libhsl.dylib&quot;, # Adjust path                                 :linear_solver =&gt; &quot;ma57&quot;) # Use ma57, ma86 or ma97</code>   The <a href="https://github.com/jump-dev/Ipopt.jl?tab=readme-ov-file#linear-solvers">Ipopt.jl README</a> suggests to use the larger LibHSL package for which there exists a Julia module and proceed similarly. In addition, users may try an <a href="https://github.com/jump-dev/Ipopt.jl?tab=readme-ov-file#blas-and-lapack">optimized BLAS</a> and see if it yields significant performance gains (and let me know if it does). </p></li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 24 July 2024 09:27">Wednesday 24 July 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
